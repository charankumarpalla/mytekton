apiVersion: tekton.dev/v1alpha1
kind: Task
metadata:
  name: charan-task
spec:
  params:
    - name: repository
      description: The git repo
    - name: branch
      description: the branch for the git repo
  steps:
    - name: noshebang
      image: ubuntu
      script: echo "no shebang"
    - name: printrepo
      image: ubuntu
      script: echo "no shebang"
    - name: echo
      image: ubuntu
      command:
        - echo
      args:
        - "hello charan"
    # - name: kubectl-yaml
    #   image: alpine
    #   command: ["sed"]
    #   args:
    #     - "-i"
    #     - "-e"
    #     - "s;IMAGE;$(inputs.params.imageUrl):$(inputs.params.imageTag);g"
    #     - "$(inputs.resources.git-source.path)/$(inputs.params.pathToContext)/$(inputs.params.pathToYamlFile)"
    # - name: kubectl-commands
    #   image: lachlanevenson/k8s-kubectl
    #   command: ["kubectl"]
    #   args:
    #     - "get"
    #     - "pods"
    # - "$(inputs.resources.git-source.path)/$(inputs.params.pathToContext)/$(inputs.params.pathToYamlFile)"
    - name: kubectl-commands
      image: widerin/openshift-cli
      stage: deploy
      script:
        # - oc login
        - oc login --token=IAnpGQPE3h8AclTAIrDd_G58fGVOC050VoPhy9049s4 --server=https://c106-e.us-south.containers.cloud.ibm.com:31711
        - oc projects
        # - cat app.yaml | envsubst > app.yaml
        # - oc replace -f app.yaml -n ${CI_PROJECT_NAME/_/}
